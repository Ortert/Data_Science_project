# Oписание проекта - Исследование данных для HR-аналитики.

## Данные

Для этой задачи заказчик предоставил данные с признаками:

- id — уникальный идентификатор сотрудника;
- dept — отдел, в котором работает сотрудник;
- level — уровень занимаемой должности;
- workload — уровень загруженности сотрудника;
- employment_years — длительность работы в компании (в годах);
- last_year_promo — показывает, было ли повышение за последний год;
- last_year_violations — показывает, нарушал ли сотрудник трудовой договор за последний год;
- supervisor_evaluation — оценка качества работы сотрудника, которую дал руководитель;
- salary — ежемесячная зарплата сотрудника;
- job_satisfaction_rate — уровень удовлетворённости сотрудника работой в компании, целевой признак.

## Задачи

1. Построить модель, которая сможет предсказать уровень удовлетворённости сотрудника.
2. Построить модель, которая сможет на основе данных заказчика предсказать то, что сотрудник уволится из компании.

## Используемые библиотеки
*pandas*, *matplotlib*, *seaborn*, *numpy*, *sklearn*, *phik*, *scipy*

## Вывод

**Задача№1:**

Необходимые для проведения исследования датафреймы были удачно загружены. Визуально проверено, что данные отображаются корректно, имена столбцов соответствуют "змеиному регистру".

Датасеты проверены на наличие пропусков, корректность типа данных, явных и неявных дубликатов, а также дубликатов по номеру id. Обнаруженные пропуски в датасетах train_1 и test будут обработаны в рамках работы с пайплайном. Пробелы содержащиеся в  столбцах 'dept' и 'workload' датасета test были заменены на NaN и впоследствии также будут обработаны в пайплайне. Также была исправлена  орфографическая ошибка в значении 'senior' столбца 'level'.

Выполнен исследовательский анализ изучаемых датасетов. Изучены распределения количественных и категориальных парметров. В целом выбросов и аномальных значений не выявлено. "Ящик с усами" показал что значения ежемесячной зароботной платы ('salary') превышающие отметку в 75 000, являются выбросами, однако реальный оснований так считать не имеется, скорее всего это зарплаты руководящего состава или особо ценных/квалифицированных сотрудников.
Построены матрицы корреляции для датасетов train_1 и test

*train_1:*
Согласно шкале Чеддока высокой корреляцией с целвым признаком обладает признак 'supervisor_evaluation' - 0.73, заметная корреляция отмечается у таргета и признака 'last_year_violations' - 0.59.

Изучено рассеяние уровня удовлетворенности работой в компании относительно уровня ежемесячной платы, с учетом паспределений по остальным входным признакам

Стоит обратить внимание на следующие зависмости:
 - сотрудники получившие повышение за последний год выставляют самые высокие оценки удовлетворенности работой.  Значения заработной платы для большинства сотрудников, получивших повышение, лежат в диапазоне 30 000 - 80 000. Сотрудники с зарплатой до 30 000 достаточно редко получают повышения.
 - сотрудники получившие повышение за последний год, выставляют самые высокие оценки удовлетворенности работой.  Значения заработной платы для большинства сотрудников, получивших повышение, лежат в диапазоне 30 000 - 80 000. Сотрудники с зарплатой до 30 000 достаточно редко получают повышения.
 - сотрудники нарушившие условия трудового договора за последний год, выставляют большую часть наиболее низких оценок удовлетворенности работой.  Значения заработной платы для большинства сотрудников, нарушивших условия трудового договора, лежат в диапазоне 0 - 40 000. Сотрудники с зарплатой свыше 60 000 заметно реже нарушают договор.
 - струдники получившие  высокие (4 и 5) оценки от руководителя выставляют самые высокие оценки удовлетворенности работой.  
Заметна следующая тенденция:
- диапазон коэффициента удовлетворенности 0.6 - 1.0 содержит преимущественно сотрудников получивших оценку руководителя 4 и 5;
- диапазон 0.4-0.6 не имеет какой то конкретной закономерности и содержит в себе сотрудников с оценками от 1 до 5;
- диапазон 0 - 0.4 содержит преимущественно сотрудников получивших оценки руководителя от 1 до 3;

При этом уровень заработной платы фактически не влияет на оценку выставляемую руководителем.

Относительно корреляции между входными признакками:
 - отмечается высокая корреляция между входнвми признаками 'salary' и 'workload' - 0.79, а также между 'salary' и 'level' - 0.72
 - заметная корреляция имеет место между признаками 'level' и 'employment_years' - 0.68.
 Учтем данные взаимосвязи при фильтрации признаков с целью подбора лучшей модели
 
 *test:*
Согласно шкале Чеддока, между входными признаками наблюдаются следующие взаимосвязи:

отмечается высокая корреляция между входнвми признаками 'salary' и 'workload' - 0.79 (аналогично датасета train_1, а также между 'salary' и 'level' - 0.75 (в датасете train_1 аналогичный коэффициент равен 0.72)
заметная корреляция имеет место между признаками 'level' и 'employment_years' - 0.69 (в датасете train_1 аналогичный коэффициент равен 0.68)

 Выполнена подготовка данных для дальнейшего моделирования, датасеты test и target приведены к единнобразному порядку относительно id работников. Из датасета train_1 удалены столбцы 'id' и 'job_satisfaction_rate'. Параметры в столбцах 'dept', 'last_year_promo', 'last_year_violations' закодированы с помощью OneHotEncoder, параметры 'level', 'workload' закодированы с помощью OrdinalEncoder, количественные столбцы отмасштабированы StandardScaler.
 
Необходимую метрику SMAPE < 15 на тестовой выборке получилось достичь при использовании модели DecisionTreeRegressor. Данная модель показала себя лучше, чем модель LinearRegression, ввиду отстусвия линейной связи между входными и целевым признаком, которые требуются для нормальной работы модели линейной регрессии.

**Задача№2:**

Необходимые для проведения исследования датафреймы загружены. Визуально проверено, что данные отображаются корректно, имена столбцов соответствуют "змеиному регистру".

Датасеты проверены на наличие пропусков, корректность типа данных, явных и неявных дубликатов, а также дубликатов по номеру id. Обнаруженные пропуски в датасетах train_1 и test будут обработаны в рамках работы с пайплайном. Пробелы содержащиеся в  столбцах 'dept' и 'workload' датасета test были заменены на NaN и впоследствии также будут обработаны в пайплайне. Также была исправлена  орфографическая ошибка в значении 'senior' столбца 'level'

Выполнен исследовательский анализ изучаемых датасетов. Изучены распределения количественных и категориальных парметров. В целом выбросов и аномальных значений не выявлено. "Ящик с усами" показал что значения ежемесячной зароботной платы ('salary') превышающие отметку в 75 000, являются выбросами, однако реальный оснований так считать не имеется, скорее всего это зарплаты руководящего состава или особо ценных/квалифицированных сотрудников. Построены матрицы корреляции для датасетов train_2.

Согласно шкале Чеддока заметной корреляцией с целевым признаком, обладает признаки 'employment_years' - 0.66, и 'salary' - 0.56.

Также обратим внимание, что входной признак 'dept' обладает нулевой корреляцией относительно целевого признака 'quit'.

Изучено рраспределение входных параметров в разбивке по таргету 'quit'.
Стоит обратить внимание на следующие зависмости:

- доля значения 'yes' в распределении параметра 'dept' для всех депратаментов составляет приблизительно одинаковую долю наименьшая доля уволившихся в департаменте 'hr': 0.25, наибольшая в 'technology': 0.297), что позволяет сделать вывод что решение об увольнение принимается сотрудником безотносительно его подчиненности тому или иному департаменту компании.

  доля значения 'yes' в распределении параметра 'level' имеет следующие закономерности:
- количество увольняющихся сотрудников обратно пропорцианально уровню их должности;
- меньше всего увольняющихся среди работников уровня 'senior', среди сотрудников 'middle' доля увольняющихся чуть больше, распределение увольняющихся среди 'junior' разительно отличается от двух вышеупомянутых категорий, доля увольняющихся сотрудников здесь превышает 50%


  доля значения 'yes' в распределении параметра 'workload' имеет следующие закономерности:
- количество увольняющихся сотрудников обратно пропорцианально уровню их загруженности;
- меньше всего увольняющихся среди работников с загруженностью 'high', среди сотрудников 'medium' доля увольняющихся чуть больше, распределение увольняющихся среди сотрудников загруженностью 'low' разительно отличается от двух вышеупомянутых категорий, доля увольняющихся сотрудников здесь превышает составляет около 40%.

  доля значения 'yes' в распределении параметра 'employment_years' имеет следующие закономерности:
- количество увольняющихся сотрудников обратно пропорцианально уровню стажу работы;
- больше всего увольняющихся, среди сотрудников имеющих стаж работы 1 год, со стажа 2 года доля увольняющихся заметно снижается(однако остается высокой), при стаже в три года, доля увольняющихся немного уменьшается, относительно тех, кто работает 2 года. Начиная со стажа в 4 года, доля увольняющихся начинает резко снижаться и для сотрудников имеющих стаж 8 лет и более, становится крайне мала.

  доля значения 'yes' в распределении параметра 'last_year_promo' имеет следующую закономерность:
- сотрудники получившие повышение за последний год, не склонны к увольнению.

  доля значения 'yes' в распределении параметра 'last_year_violations' имеет следующие закономерности:
- количество увольняющихся сотрудников обратно пропорцианально факту нарушения ими трудового договора за последний год;
- количество увольняющихся преобладает среди работников, нарушивших условия трудового договора за последний год, существенно выше, чем  среди сотрудников не нарушавших договор.

  доля значения 'yes' в распределении параметра 'supervisor_evaluation' имеет следующие закономерности:
- количество увольняющихся сотрудников обратно пропорцианально оценке, выставленной руководителем сотрудников;
- количество увольняющихся весьма заметна для сотрудников, получивших оценку руководителя от 1 до 3;
- количество увольняющихся для сотрудников получивших оценки 4 и 5 заметно снижается

  доля значения 'yes' в распределении параметра 'salary' имеет следующие закономерности:
- количество увольняющихся сотрудников обратно пропорцианально величине ежемесячной зарплаты;
- наибольшее количество увольняющихся сотрудников получает зарплату менее 30 000 (медианное значение)
- при зарплате 30 000 - 35 000 происходит заметное снижение количества увольняющихся
- при зарплате более 35 000 доля увольняющихся сокращается еще заметнее, сходя на нет для сотрудников, с зарплатой более 50 000

Также было изучено распределение признака 'job_satisfaction_rate' по таргету 'quit'.
В результате были выявлены следующие взаимосвязи:

  доля значения 'yes' в распределении параметра 'job_satisfaction_rate' имеет следующие закономерности:
- количество увольняющихся сотрудников обратно пропорцианально уровню удовлетворенности работой;
- наибольшее количество увольняющихся сотрудников имеют уровень удовлетворенности от 0.1 до 0.3
- в диапазоне 0.3-0.45 происходит заметное снижение количества увольняющихся
- при уровне удовлетворенности более 0.45 доля увольняющихся сокращается еще заметнее, постепенно сходя на нет, для сотрудников, с уровнем удовлетворенности выше 0.75

Входной признак job_satisfaction_rate, предсказанный лучшей моделью первой задачи, успешно добавлен к входным признакам второй задачи.

Выполнена подготовка данных для дальнейшего моделирования, датасеты test_2 и target_2 приведены к единнобразному порядку относительно id работников. Из датасета train_3 удалены столбцы 'id' и 'quit'. Параметры в столбцах 'dept', 'last_year_promo', 'last_year_violations' закодированы с помощью OneHotEncoder, параметры 'level', 'workload' закодированы с помощью OrdinalEncoder, количественные столбцы отмасштабированы StandardScaler.

По итогам созданного пайплайна отобрана лучшая модель, которая позволилиа спрогнозировать целевой признак с метрикой, соответствующей требованиям задания (ROC-AUC ≥ 0.91).
По итогу работы пайплайна получена модель с наилучшеми характеристиками, это Метод опорных методов SVC(probability=True, random_state=77, 'kernel': 'rbf'), в качестве кодировщиков использовались OneHotEncoder() и OrdinalEncoder, в качестве скейлеоа использовался MinMaxScaler().

По итогу работы данной модели получены следующие метрики на спрогнозированных значениях:

Лучшая метрика на кросс-валидационной выборке: 0.9284507476043155

Метрика ROC-AUC на тестовой выборке: 0.9225920602935658

**Рекомендации для Заказчика:** По итогам проведенных исследований, с целью уменьшения количества увольняющихся сотрудников, а таккже увеличения уровня удовлетворенности работой (что влияет на первый показатель), предлагается:

- проводить работу с сотрудниками уровня 'junior', направленную на повышение их мотивации (менторство, удовлетворенность от выполнения текущих задач и т.д.);
- следить за уровнем загруженности сотрудников, т.к. сотрудники с низким уровнем загрузки склонны к увольнениям
- раз в год проводить аттестацию сотрудников, итоги работы которых, предполагают повышение по должности;
- донести до руководителей требование, о выставлении справедливых и обоснованных оценок сотрудникам (исключая предвзятость, личную неприязнь и т.д.);
- проводить беседу о дальнейшей мотивации и развитии в компании, для сотрудников, допускающих нарушения трудового договора;
- повысить заработную плату сотрудникам, к выполнению обязаннностей которых нет вопросов, со стороны руководства, если позволяет бюджет.
