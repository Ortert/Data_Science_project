# Oписание проекта - Определение стоимости автомобилей.

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В нашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей.

## Данные

Согласно документации к данным, данные находятся в файле autos.csv и содержит следующие признаки:

- DateCrawled — дата скачивания анкеты из базы
- VehicleType — тип автомобильного кузова
- RegistrationYear — год регистрации автомобиля
- Gearbox — тип коробки передач
- Power — мощность (л. с.)
- Model — модель автомобиля
- Kilometer — пробег (км)
- RegistrationMonth — месяц регистрации автомобиля
- FuelType — тип топлива
- Brand — марка автомобиля
- Repaired — была машина в ремонте или нет
- DateCreated — дата создания анкеты
- NumberOfPictures — количество фотографий автомобиля
- PostalCode — почтовый индекс владельца анкеты (пользователя)
- LastSeen — дата последней активности пользователя
- Price — цена (евро)

## Задача

Построить модель для определения стоимости автомобиля. Необходимо учесть условия, которые важны для заказчика:

- качество предсказания (метрика RMSE < 2500);
- скорость предсказания;
- время обучения.

## Используемые библиотеки
*pandas*, *matplotlib*, *seaborn*, *numpy*, *scipy*, *lightgbm*, *catboost*, *sklearn*, *phik*, *tqdm*

## Вывод

В рамках подготовки к обучению моделей, были загружены необходимые для выполнения исследования данные, выявлены имеющиеся в датасете пропуски. Пропуски в параметре Model отнесены к серии  other, параметры VehicleType, Gearbox и FuelType восстановдены максимальными значениями данных параметров по объектам с аналогичными показателями  Brand, Model и Power. Пропуски в параметре Repaired заменены на заглушку unknown. Также в датасете выявлены 4 неявных дубликата, которые были удалены. Проведен исследовательский анализ данных в процессе которого были удалены объекты с аномальными значениями Price, Power, RegisrationYear. Сформирована матрица корреляции входных признаков с целевым и между собой. Признаки  DateCrawled, DateCreated, NumberOfPictures, PostalCode, LastSeen удалены как неинформативные. Сформированы графики рассеяния входных признаков с целевым. Условно линейна зависимость с целевым признаком есть у признаков RegistrationYear и Power.

Обучение и предсказание цевеого параметра выполнялось на базе трех моделей:
- LinearRegression 
- LGBMRegressor 
- CatBoostRegressor

По итогу обучения и предсказания стоимости подержанного автомобиля с помощью моделей LinearRegression, LGBMRegressor и CatBoostRegressor можно прийти к следующим выводам:

 - *LinearRegression* при применении кодировщика OneHotEncoder укладывалась в лимит по метрике (RMSE = 2641) с минимальным запасом и при этом обучается слишком долго (около 18 секунд). Предсказания при этом выполняются моделью быстро - около 170 мс.
 - *LGBMRegressor* обучается быстрее всех(около 7 секунд), имеет хорошую метрику (RMSE = 1620), по времени предсказания проигрывает двум другим моделям (около 600 мс). Сочетание метрика/время обучения и предсказания данной модели можно регулировать гиперпараметром n_estimators. В рамках данного исследования обучение и предсказания получали при значении  n_estimators = 100, что является гиперпараметром по умолчанию.
 - *CatBoostRegressor* обучается дольше LGBMRegressor (около 10 секунд, причем на базовых гиперпараметрах существенно дольше - время обучения более 1 минуты), предсказания выполняет быстрее LGBMRegressor (около 120 мс, но немного проигрывает в метрике (RMSE = 1649). В рамках обучения обучение и предсказание проводили на количестве итераций = 50, что дает оптимальное сочетание метрика/время обучения.
 
С учетом вышесказанного, наилучшей моделью по сочетанию факторов время обучения, время работы и RMSE была признана модель LGBMRegressor, было проведено тестирование данной модели, чтобы убедиться что данные результаты были достигнуты не в результате переобучения.

По результату работы лучшей модели на тестовых данных время обучения составило около 8 сек, время предсказания - около 600 мс, итоговая метрика  RMSE = 1613 . Данные результаты существенно не отличаются от результатов на валидационной выборке, что говорит о корректной работе алгоритма.



По итогу проведенного исследования наилучшей моделью по сочетанию факторов время обучения, время работы и RMSE являтся модель LGBMRegressor, т.к. имеет лучшую метрику и быстрее всех обучается. Несмотря на то, что модель дольше всех делает предсказание, в абсолютной величине 600 мс видится весьма приемлимым быстродействием. Модель может быть рекомендована Заказчику 
