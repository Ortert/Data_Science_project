# Oписание проекта - Предсказание стоимости жилья.

## Данные

Предоставлена информация о жилых массивах в Калифорнии в 1990 году:

- longitude — широта;
- latitude — долгота;
- housing_median_age — медианный возраст жителей жилого массива;
- total_rooms — общее количество комнат в домах жилого массива;
- total_bedrooms — общее количество спален в домах жилого массива;
- population — количество человек, которые проживают в жилом массиве;
- households — количество домовладений в жилом массиве;
- median_income — медианный доход жителей жилого массива;
- median_house_value — медианная стоимость дома в жилом массиве;
- ocean_proximity — близость к океану.

## Задачи

1. Нужно предсказать медианную стоимость дома в жилом массиве.
2. Сравнить результаты работы модели на двух наборах данных (с категориальными и без категориальных данных) по метрикам RMSE, MAE и R2.

## Используемые библиотеки
*pandas*, *matplotlib*, *seaborn*, *numpy*, *pyspark*

## Вывод

В рамках выполнения данного проекта:

инициализована локальная Spark-сессия;
загружены необходимые для выполнения исследования данные. Выведены типы данных параметров методами pySpark. Выведены базовые статистики по столбцам датафрейма.
в рамках предобработки данных датасет проверен на наличие пропусков. Выявленные пропуски в столбце 'total_bedroms', заменены на медианное значение по данному столбцу. Также столбец 'ocean_proximity' содержащий категориальные значения, обработан с помощью StringIndexer и OneHotEncoder, количественные признаки обработаны с помощью StandardScaler. Все трансформированные признаки собраны в итоговый вектор.
получены предсказания таргета, с использованием модели линейной регрессии, на 4-х наборах данных:
весь набор признаков, содержащийся в исходном наборе данных;
использование только количественных признаков, содержащихся в исходном наборе;
использование набора всех признаков, с учетом добавленных синтетических данных;
использование только количественных признаков, с учетом добавленных синтетических данных. Качество работы модели оценено метриками RMSE, MAE и R2.
для всех трех полученных метрик: RMSE, MAE и R2 справедлива следующая зависимость их распределения, в зависимости от набора данных преданных для обучения модели (далее модели перечислены от лучшего результата к худшему):
модель, которой был передан набор всех данных из исходного набора + синтетические признаки (RMSE = 67_604 , MAE = 48_897, R2 = 0.653);
модель, которой был передан набор всех данных из исходного набора (RMSE = 68_276, MAE = 49_529 , R2 = 0.646);
модель, которой был передан набор только количественных данных + синтетческие признаки (RMSE = 68_370, MAE = 49_781, R2 = 0.645);
модель, которой был передан набор только количественных данных из исходного набора (RMSE = 69_208, MAE = 50_642 , R2 = 0.637)
Отсюда можно прийти к выводу что категориальные данные, содержащиеся в столбце 'ocean_proximity' улучшают обобщающую способность модели и повышают исследуемые метрики. Стоит обратить внимание, что использование синтетических признаков, также повышают точность прогноза модели и может практически нивелировать отстутсвие категориального признака, в передаваемых для обучения данных.
