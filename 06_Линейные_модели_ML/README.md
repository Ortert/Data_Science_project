# Выбор коров с определёнными характеристиками молока для фермерского хозяйства

## Описание проекта

Заказчик проекта - фермер, владелец молочного хозяйства «Вольный луг». Он хочет купить коров, чтобы расширить поголовье стада. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма».

Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям, ничуть не хуже.

## Данные

Данные состоят из трёх датасетов:
- данные о стаде фермера на текущий момент (характеристики коровы, характеристики корма, характеристика пастбища, характеристики молока);
- имя папы каждой коровы в стаде фермера;
- данные о коровах «ЭкоФермы», которых фермер хочет изучить перед покупкой.

## Задача исследования

Разработать модель машинного обучения, которая поможет фермеру управлять рисками и принимать объективное решение о покупке.  Для этого необходимо создать две прогнозные модели для отбора бурёнок в поголовье:
- Первая будет прогнозировать возможный удой коровы (целевой признак Удой);
- Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока). С помощью модели нужно отобрать коров по двум критериям:
средний удой за год — не менее 6000 килограммов;
молоко должно быть вкусным.

## Используемые библиотеки

*pandas*, *numpy*, *scipy*, *matplotlib*, *seaborn*, *sklearn*

## Выводы 

На основании исследований проведенных выше, определим коров из датасета buy, удовлетворяющие запросу закзачика (Удой не менее 6000 кг и вкус молока "вкусно")

Для этого найдем пересечения в датасетах buy_res (коровы с удоем не менее 6000 кг, с учетом доверительного интервала 0.95) и buy_res_2 (коровы дающие вкусное молоко).

По итогу прогноза количественного параметра Удой, кг ('yield') с помощью модели линейной регрессии и категориального параметра Вкус молока ('taste_of_milk') с помощью модели логистической регрессии, получены следующие данные:

из 20 коров датасета buy 10 коров имеют прогноз параметра Удой ('yield') не менее 6000 кг, с учетом доверительного интервала 0.95;
из 20 коров датасета buy 5 коров имеет прогноз параметра Вкус молока('taste_of_milk') 1, что соответствует значению "Вкусно";

К покупке рекомендуется 3 коровы под индексами 0, 12 и 13 в исходной таблице cow_buy Модель линейной регресии имеет коэффициент детерминации R² = 0.829945393216066 для лучшей итерации, то есть ошибается в 17,5% случаев. Требуются дополнительные данные для улучшения модели. Метрики accuracy и precision для модели логистической регрессии при стандартном пороге составляют 0.6624203821656051 и 0.6788990825688074 соответственно, что говорит о необходимости изучения дополнительных данных для улучшения точночти модели. Для минимизации критической ошибки модели логистической регрессии порог классификации был увеличен со стандартного значения 0.5 до значения 0.77534. При таком пороге классификация ошибка первого рода сведена к нулю, соответcтdенно без изменения входных признаков улучшить точность модели не представляется возможным. В случае если заказчику все же требуется купить более 3 коров и нет возможности получить дополнительные данные для уточнения модели, необходимо обсудить с ним возможность снижения метрики precision (с учетом соответсвующих рисков).

При анализе рисков или экономических расчётов с использованием моделей классификации, в том числе логистической регрессии важны метрики accuracy и precision и recall. Максимизация какой либо из этих метрик, зависит от поставленной задачи.
